start_year <- 1980
start_quarter <- 1
ffer_ts <- ts(ffer_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(ffer_ts)
pcepi_full <- pcepi_full %>% mutate(q = quarter(date))
pcepi_full$q_factor <- factor(pcepi_full$q, levels = c("1", "2", "3", "4"))
ggplot(pcepi_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
pcepi_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q1", x = "Date", y = "Value")
pcepi_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q2", x = "Date", y = "Value")
pcepi_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q3", x = "Date", y = "Value")
pcepi_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
pcepi_ts <- ts(pcepi_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(pcepi_ts)
gdp_full <- gdp_full %>% mutate(q = quarter(date))
gdp_full$q_factor <- factor(gdp_full$q, levels = c("1", "2", "3", "4"))
ggplot(gdp_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
gdp_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q1", x = "Date", y = "Value")
gdp_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q2", x = "Date", y = "Value")
gdp_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q3", x = "Date", y = "Value")
gdp_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
gdp_full_ts <- ts(gdp_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(gdp_full_ts)
pot_gdp_full <- pot_gdp_full %>% mutate(q = quarter(date))
pot_gdp_full$q_factor <- factor(pot_gdp_full$q, levels = c("1", "2", "3", "4"))
ggplot(pot_gdp_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
pot_gdp_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q1", x = "Date", y = "Value")
pot_gdp_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q2", x = "Date", y = "Value")
pot_gdp_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q3", x = "Date", y = "Value")
pot_gdp_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
pot_gdp_full_ts <- ts(pot_gdp_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(pot_gdp_full_ts)
pcepi_fit <- seas(pcepi_ts)
pcepi_full$s_adj_val <- final(pcepi_fit)
pot_gdp_fit <- seas(pot_gdp_full_ts)
pot_gdp_full$s_adj_val <- final(pot_gdp_fit)
pot_gdp_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = s_adj_val, color = "Seasonally Adjusted")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "GDPPOT",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Seasonally Adjusted" = "blue", "Original" = "red"),
name = "Legend")
pcepi_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = s_adj_val, color = "Seasonally Adjusted")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "PCEPI",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Seasonally Adjusted" = "blue", "Original" = "red"),
name = "Legend")
# # Split into train and test set
# ffer_train <- ffer_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# ffer_test <- ffer_full %>% filter(date >= as.Date('2024-01-01'))
#  # # Split into train and test set
# pcepi_train <- pcepi_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# pcepi_test <- pcepi_full %>% filter(date >= as.Date('2024-01-01'))
#  # # Split into train and test set
# gdp_train <- gdp_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# gdp_test <- gdp_full %>% filter(date >= as.Date('2024-01-01'))
#  # # Split into train and test set
# pot_gdp_train <- pot_gdp_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# pot_gdp_test <- pot_gdp_full %>% filter(date >= as.Date('2024-01-01'))
infl_data_tsbl <- ffer_full %>%
select(date, hampel_val) %>%
rename(FEDFUNDS_hampel = hampel_val) %>%
left_join(pcepi_full, by = "date") %>%
select(date, FEDFUNDS_hampel, s_adj_val, pct_chg_pce) %>%
rename(PCEPI_s_adj = s_adj_val) %>%
left_join(gdp_full, by = "date") %>%
select(date, FEDFUNDS_hampel, PCEPI_s_adj, pct_chg_pce, hampel_val) %>%
rename(GDPC1_hampel = hampel_val) %>%
left_join(pot_gdp_full, by = "date") %>%
select(date, FEDFUNDS_hampel, PCEPI_s_adj, pct_chg_pce, GDPC1_hampel, s_adj_val) %>%
rename(GDPPOT_s_adj = s_adj_val) %>%
mutate(
output_gap = 100 * (GDPC1_hampel - GDPPOT_s_adj) / GDPPOT_s_adj,
pct_chg_pce_s_adj = (PCEPI_s_adj / lag(PCEPI_s_adj) - 1),
inflation_gap = pct_chg_pce_s_adj - 0.02,
date = yearquarter(date)
) %>%
as_tsibble(index = date)
infl_data_tsbl_train <- infl_data_tsbl %>%
filter(date <= yearquarter("2022 Q4"))
infl_data_tsbl_test <- infl_data_tsbl %>%
filter(date > yearquarter("2022 Q4"))
taylor_mod <- lm(FEDFUNDS_hampel ~ inflation_gap + output_gap,
data = infl_data_tsbl_train)
summary(taylor_mod)
taylor_resid <- resid(taylor_mod)
adf.test(taylor_resid)
# full residuals to add back to tsibble
long_run_model <- lm(FEDFUNDS_hampel ~ inflation_gap + output_gap,
data = infl_data_tsbl)
long_run_resid <- c(NA, resid(long_run_model))
# add ECM variables
infl_data_tsbl_ecm <-  infl_data_tsbl %>%
mutate(
d_it = FEDFUNDS_hampel - lag(FEDFUNDS_hampel),
d_infl_gap = inflation_gap - lag(inflation_gap),
d_output_gap = output_gap - lag(output_gap),
lag_resid = lag(long_run_resid)
)
infl_data_tsbl_ecm_train <- infl_data_tsbl_ecm %>%
filter(date <= yearquarter("2022 Q4"))
infl_data_tsbl_ecm_test <- infl_data_tsbl_ecm %>%
filter(date > yearquarter("2022 Q4"))
ecm_model <- lm(d_it ~ d_infl_gap + d_output_gap + lag_resid,
data = infl_data_tsbl_ecm)
summary(ecm_model)
ecm_model_train <- lm(d_it ~ d_infl_gap + d_output_gap + lag_resid,
data = infl_data_tsbl_ecm_train)
summary(ecm_model_train)
ecm_fc <- forecast(ecm_model_train, newdata = infl_data_tsbl_ecm_test)
View(infl_data_tsbl_train)
View(infl_data_tsbl_test)
fc <- forecast(taylor_mod, newdata = infl_data_tsbl_test)
fc <- forecast(taylor_mod, newdata = as.data.frame(infl_data_tsbl_test)
fc <- forecast(taylor_mod, newdata = as.data.frame(infl_data_tsbl_test))
View(fc)
ecm_fc <- forecast(ecm_model_train, newdata = as.data.frame(infl_data_tsbl_ecm_test))
library(tidyverse)
library(dplyr)
library(ggplot2)
library(lubridate)
#install.packages("fredr")
library(fredr)
#install.packages("DescTools")
library(DescTools)
#install.packages("pracma")
library(pracma)
#install.packages("seastests")
library(seastests)
#install.packages(c("seasonal", "x13binary"))
library(seasonal)
library(tseries)
library(forecast)
api_key <- '3949fd9fcfaa43711339ce7b8a243180'
fredr_set_key(api_key)
# Federal Funds Effective Rate (FFER)
ffer_full <- fredr(
series_id = "FEDFUNDS",
frequency = "q",              # quarterly
aggregation_method = "avg",
observation_start = as.Date("1980-01-01")
)
head(ffer_full)
# Personal Consumption Expenditures Index (PCEPI) - Inflation measure
pcepi_full <- fredr(
series_id = "PCEPI",
frequency = "q",
aggregation_method = "avg",
observation_start = as.Date("1980-01-01")
)
head(pcepi_full)
# Real GDP
gdp_full <- fredr(
series_id = "GDPC1",
frequency = "q",
aggregation_method = "avg",
observation_start = as.Date("1980-01-01")
)
head(gdp_full)
# Potential Real GDP
pot_gdp_full <- fredr(
series_id = "GDPPOT",
frequency = "q",
aggregation_method = "avg",
observation_start = as.Date("1980-01-01")
)
head(pot_gdp_full)
# Add pct_chg_pce col to PCE series
t_val <- pcepi_full$value
t_minus_one_val <- lag(pcepi_full$value, 1)
pcepi_full$pct_chg_pce <- (t_val - t_minus_one_val) / t_minus_one_val
gdp_merged <- inner_join(gdp_full, pot_gdp_full, by='date')
# Add Output Gap col to GDP series
gdp_merged$output_gap <- (gdp_merged$value.x - gdp_merged$value.y) * 100 / gdp_merged$value.y
gdp_merged$series_id <- 'OUTPUTGAP'
gdp_merged <- gdp_merged %>% rename(realtime_start = realtime_start.x, realtime_end = realtime_end.x, value=output_gap)
output_gap <- gdp_merged %>% select(date, series_id, value, realtime_start, realtime_end)
ffer_full %>%
ggplot(aes(x = date, y = value)) +
geom_line() +
labs(title = "Federal Funds Effective Rate (FFER)",
x = "date",
y = 'FFER')
ffer_full %>%
summarize(
mean = mean(value, na.rm = TRUE),
var_value  = var(value, na.rm = TRUE),
sd_value   = sd(value, na.rm = TRUE),
n_obs      = n()
)
pcepi_full %>%
ggplot(aes(x = date, y = value)) +
geom_line() +
labs(title = "Personal Consumption Expenditures Index (PCEPI)",
x = "date",
y = 'PCEPI')
pcepi_full %>%
summarize(
mean = mean(value, na.rm = TRUE),
var_value  = var(value, na.rm = TRUE),
sd_value   = sd(value, na.rm = TRUE),
n_obs      = n()
)
pcepi_full %>%
ggplot(aes(x = date, y = pct_chg_pce)) +
geom_line() +
labs(title = "Pct Change PCE",
x = "date",
y = 'Pct Change PCE')
# Do regular GDP, POT GDP, and output gap
gdp_full %>%
ggplot(aes(x = date, y = value)) +
geom_line() +
labs(title = "Real GDP ",
x = "date",
y = 'GDP')
gdp_full %>%
summarize(
mean = mean(value, na.rm = TRUE),
var_value  = var(value, na.rm = TRUE),
sd_value   = sd(value, na.rm = TRUE),
n_obs      = n()
)
pot_gdp_full %>%
ggplot(aes(x = date, y = value)) +
geom_line() +
labs(title = "Potential Real GDP ",
x = "date",
y = 'GDPPOT')
pot_gdp_full %>%
summarize(
mean = mean(value, na.rm = TRUE),
var_value  = var(value, na.rm = TRUE),
sd_value   = sd(value, na.rm = TRUE),
n_obs      = n()
)
output_gap %>%
ggplot(aes(x = date, y = value)) +
geom_line() +
labs(title = "Output gap",
x = "date",
y = 'Output gap')
ensure_same_dates <- ffer_full %>%
full_join(gdp_full, by='date') %>%
full_join(pcepi_full, by='date') %>%
full_join(pot_gdp_full, by='date') %>%
full_join(output_gap, by='date')
# Filter all to 2025-04-01 after visual examination of the data
ffer_full <- ffer_full %>% filter(date <= as.Date('2025-04-01'))
pcepi_full <- pcepi_full %>% filter(date <= as.Date('2025-04-01'))
pot_gdp_full <- pot_gdp_full %>% filter(date <= as.Date('2025-04-01'))
output_gap <- output_gap %>% filter(date <= as.Date('2025-04-01'))
ffer_full$hampel_val <- hampel(ffer_full$value, k = 5)[[1]]
ffer_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = hampel_val, color = "Hampel")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "Federal Funds Effective Rate (FFER)",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Hampel" = "blue", "Original" = "red"),
name = "Legend")
pcepi_full$hampel_val <- hampel(pcepi_full$value, k = 5, )[[1]]
pcepi_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = hampel_val, color = "Hampel")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "PCEPI",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Hampel" = "blue", "Original" = "red"),
name = "Legend")
gdp_full$hampel_val <- hampel(gdp_full$value, k = 5, )[[1]]
gdp_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = hampel_val, color = "Hampel")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "GDP",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Hampel" = "blue", "Original" = "red"),
name = "Legend")
pot_gdp_full$hampel_val <- hampel(pot_gdp_full$value, k = 5, )[[1]]
pot_gdp_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = hampel_val, color = "Hampel")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "GDPPOT",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Hampel" = "blue", "Original" = "red"),
name = "Legend")
output_gap$value <- (gdp_full$hampel_val - pot_gdp_full$hampel_val) * 100 / pot_gdp_full$hampel_val
ffer_full <- ffer_full %>% mutate(q = quarter(date))
ffer_full$q_factor <- factor(ffer_full$q, levels = c("1", "2", "3", "4"))
ggplot(ffer_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
ffer_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "FFER Q1", x = "Date", y = "Value")
ffer_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "FFER Q2", x = "Date", y = "Value")
ffer_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "FFER Q3", x = "Date", y = "Value")
ffer_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "FFER Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
ffer_ts <- ts(ffer_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(ffer_ts)
pcepi_full <- pcepi_full %>% mutate(q = quarter(date))
pcepi_full$q_factor <- factor(pcepi_full$q, levels = c("1", "2", "3", "4"))
ggplot(pcepi_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
pcepi_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q1", x = "Date", y = "Value")
pcepi_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q2", x = "Date", y = "Value")
pcepi_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q3", x = "Date", y = "Value")
pcepi_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "PCEPI Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
pcepi_ts <- ts(pcepi_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(pcepi_ts)
gdp_full <- gdp_full %>% mutate(q = quarter(date))
gdp_full$q_factor <- factor(gdp_full$q, levels = c("1", "2", "3", "4"))
ggplot(gdp_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
gdp_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q1", x = "Date", y = "Value")
gdp_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q2", x = "Date", y = "Value")
gdp_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q3", x = "Date", y = "Value")
gdp_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDP Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
gdp_full_ts <- ts(gdp_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(gdp_full_ts)
pot_gdp_full <- pot_gdp_full %>% mutate(q = quarter(date))
pot_gdp_full$q_factor <- factor(pot_gdp_full$q, levels = c("1", "2", "3", "4"))
ggplot(pot_gdp_full, aes(x = q_factor, y = value)) +
geom_boxplot(fill = "skyblue", color = "black") +
labs(title = "Distribution of Values by Quarter",
x = "Quarter",
y = "Value") +
theme_minimal()
pot_gdp_full %>% filter(q == 1) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q1", x = "Date", y = "Value")
pot_gdp_full %>% filter(q == 2) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q2", x = "Date", y = "Value")
pot_gdp_full %>% filter(q == 3) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q3", x = "Date", y = "Value")
pot_gdp_full %>% filter(q == 4) %>% ggplot(aes(x=date, y=hampel_val)) + geom_line() + labs(title = "GDPPOT Q4", x = "Date", y = "Value")
start_year <- 1980
start_quarter <- 1
pot_gdp_full_ts <- ts(pot_gdp_full$hampel_val, start = c(start_year, start_quarter), frequency=4)
seastests::qs(pot_gdp_full_ts)
pcepi_fit <- seas(pcepi_ts)
pcepi_full$s_adj_val <- final(pcepi_fit)
pot_gdp_fit <- seas(pot_gdp_full_ts)
pot_gdp_full$s_adj_val <- final(pot_gdp_fit)
pot_gdp_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = s_adj_val, color = "Seasonally Adjusted")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "GDPPOT",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Seasonally Adjusted" = "blue", "Original" = "red"),
name = "Legend")
pcepi_full %>%
ggplot(aes(x = date)) +
geom_line(aes(y = s_adj_val, color = "Seasonally Adjusted")) +
geom_line(aes(y = value, color = "Original")) +
labs(title = "PCEPI",
x = "Date",
y = "Value") +
scale_color_manual(values = c("Seasonally Adjusted" = "blue", "Original" = "red"),
name = "Legend")
# # Split into train and test set
# ffer_train <- ffer_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# ffer_test <- ffer_full %>% filter(date >= as.Date('2024-01-01'))
#  # # Split into train and test set
# pcepi_train <- pcepi_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# pcepi_test <- pcepi_full %>% filter(date >= as.Date('2024-01-01'))
#  # # Split into train and test set
# gdp_train <- gdp_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# gdp_test <- gdp_full %>% filter(date >= as.Date('2024-01-01'))
#  # # Split into train and test set
# pot_gdp_train <- pot_gdp_full %>% filter(date >= as.Date('1980-01-01') & date <= as.Date('2023-10-01'))
# pot_gdp_test <- pot_gdp_full %>% filter(date >= as.Date('2024-01-01'))
infl_data_tsbl <- ffer_full %>%
select(date, hampel_val) %>%
rename(FEDFUNDS_hampel = hampel_val) %>%
left_join(pcepi_full, by = "date") %>%
select(date, FEDFUNDS_hampel, s_adj_val, pct_chg_pce) %>%
rename(PCEPI_s_adj = s_adj_val) %>%
left_join(gdp_full, by = "date") %>%
select(date, FEDFUNDS_hampel, PCEPI_s_adj, pct_chg_pce, hampel_val) %>%
rename(GDPC1_hampel = hampel_val) %>%
left_join(pot_gdp_full, by = "date") %>%
select(date, FEDFUNDS_hampel, PCEPI_s_adj, pct_chg_pce, GDPC1_hampel, s_adj_val) %>%
rename(GDPPOT_s_adj = s_adj_val) %>%
mutate(
output_gap = 100 * (GDPC1_hampel - GDPPOT_s_adj) / GDPPOT_s_adj,
pct_chg_pce_s_adj = (PCEPI_s_adj / lag(PCEPI_s_adj) - 1),
inflation_gap = pct_chg_pce_s_adj - 0.02,
date = yearquarter(date)
) %>%
as_tsibble(index = date)
infl_data_tsbl_train <- infl_data_tsbl %>%
filter(date <= yearquarter("2022 Q4"))
infl_data_tsbl_test <- infl_data_tsbl %>%
filter(date > yearquarter("2022 Q4"))
taylor_mod <- lm(FEDFUNDS_hampel ~ inflation_gap + output_gap,
data = infl_data_tsbl_train)
summary(taylor_mod)
taylor_resid <- resid(taylor_mod)
adf.test(taylor_resid)
# full residuals to add back to tsibble
long_run_model <- lm(FEDFUNDS_hampel ~ inflation_gap + output_gap,
data = infl_data_tsbl)
long_run_resid <- c(NA, resid(long_run_model))
# add ECM variables
infl_data_tsbl_ecm <-  infl_data_tsbl %>%
mutate(
d_it = FEDFUNDS_hampel - lag(FEDFUNDS_hampel),
d_infl_gap = inflation_gap - lag(inflation_gap),
d_output_gap = output_gap - lag(output_gap),
lag_resid = lag(long_run_resid)
)
infl_data_tsbl_ecm_train <- infl_data_tsbl_ecm %>%
filter(date <= yearquarter("2022 Q4"))
infl_data_tsbl_ecm_test <- infl_data_tsbl_ecm %>%
filter(date > yearquarter("2022 Q4"))
ecm_model <- lm(d_it ~ d_infl_gap + d_output_gap + lag_resid,
data = infl_data_tsbl_ecm)
summary(ecm_model)
ecm_model_train <- lm(d_it ~ d_infl_gap + d_output_gap + lag_resid,
data = infl_data_tsbl_ecm_train)
summary(ecm_model_train)
ecm_fc <- forecast(ecm_model_train, newdata = as.data.frame(infl_data_tsbl_ecm_test))
ecm_fc
ecm_fc$mean
ecm_fc
d_hat <- ecm_fc$mean
d_hat <- ecm_fc$mean
i_hat <- numeric(length(d_hat))
i_hat[1] <- tail(train$FEDFUNDS_hampel, 1) + d_hat[1]
d_hat <- ecm_fc$mean
i_hat <- numeric(length(d_hat))
i_hat[1] <- tail(infl_data_tsbl_ecm_train$FEDFUNDS_hampel, 1) + d_hat[1]
for (t in 2:length(d_hat)) {
i_hat[t] <- i_hat[t - 1] + d_hat[t]
}
d_hat <- ecm_fc$mean
i_hat <- numeric(length(d_hat))
i_hat[1] <- tail(infl_data_tsbl_ecm_train$FEDFUNDS_hampel, 1) + d_hat[1]
for (t in 2:length(d_hat)) {
i_hat[t] <- i_hat[t - 1] + d_hat[t]
}
ecm_rmse <- sqrt(mean((test$FEDFUNDS_hampel - i_hat)^2, na.rm = TRUE))
d_hat <- ecm_fc$mean
i_hat <- numeric(length(d_hat))
i_hat[1] <- tail(infl_data_tsbl_ecm_train$FEDFUNDS_hampel, 1) + d_hat[1]
for (t in 2:length(d_hat)) {
i_hat[t] <- i_hat[t - 1] + d_hat[t]
}
ecm_rmse <- sqrt(mean((infl_data_tsbl_ecm_test$FEDFUNDS_hampel - i_hat)^2, na.rm = TRUE))
d_hat <- ecm_fc$mean
i_hat <- numeric(length(d_hat))
i_hat[1] <- tail(infl_data_tsbl_ecm_train$FEDFUNDS_hampel, 1) + d_hat[1]
for (t in 2:length(d_hat)) {
i_hat[t] <- i_hat[t - 1] + d_hat[t]
}
ecm_rmse <- sqrt(mean((infl_data_tsbl_ecm_test$FEDFUNDS_hampel - i_hat)^2, na.rm = TRUE))
ecm_rmse
ols_fc <- forecast(taylor_mod, newdata = as.data.frame(infl_data_tsbl_test))
ols_fc <- forecast(taylor_mod, newdata = as.data.frame(infl_data_tsbl_test))
ols_pred <- ols_fc$mean
ols_rmse <- sqrt(mean((infl_data_tsbl_test$FEDFUNDS_hampel - ols_pred)^2, na.rm = TRUE))
ols_fc <- forecast(taylor_mod, newdata = as.data.frame(infl_data_tsbl_test))
ols_pred <- ols_fc$mean
ols_rmse <- sqrt(mean((infl_data_tsbl_test$FEDFUNDS_hampel - ols_pred)^2, na.rm = TRUE))
ols_rmse
